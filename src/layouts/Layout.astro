---
import "../styles/global.css";
---

<!doctype html>
<html lang="en" class="scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>Humberto Lopez Portfolio</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Space+Mono:wght@400;700&display=swap"
      rel="stylesheet"
    />
  </head>
  <body class="cursor-pixel">
    <!-- Loading Screen -->
    <div
      id="loading-screen"
      class="fixed inset-0 bg-slate-950 z-100 flex items-center justify-center"
    >
      <div class="text-center">
        <div
          class="w-16 h-16 md:w-20 md:h-20 bg-linear-to-br from-blue-500 to-cyan-400 border-2 md:border-3 border-cyan-600 mx-auto mb-6 pulse-glow relative"
        >
          <div class="absolute inset-0 pixel-grid opacity-30"></div>
          <div class="absolute inset-0 flex items-center justify-center">
            <div class="w-6 h-6 md:w-8 md:h-8 bg-cyan-300 border-2 border-blue-900"></div>
          </div>
        </div>
        <p class="pixel-font text-cyan-400 text-xs md:text-sm mb-4">LOADING...</p>
        <div
          class="w-48 md:w-64 h-6 bg-slate-900 border-2 md:border-3 border-blue-500 mx-auto overflow-hidden"
        >
          <div
            id="loading-bar"
            class="h-full bg-linear-to-r from-blue-500 via-cyan-400 to-blue-500 w-0 transition-all duration-300"
          >
          </div>
        </div>
      </div>
    </div>

    <slot />

    <!-- Scroll to Top Button -->
    <button
      id="scroll-to-top"
      class="fixed bottom-8 right-8 w-12 h-12 bg-cyan-400 border-2 md:border-3 border-cyan-600 hover:bg-cyan-300 transition-all pixel-border opacity-0 pointer-events-none z-50 flex items-center justify-center"
      style="box-shadow: 0 4px 12px rgba(6, 182, 212, 0.4);"
      aria-label="Scroll to top"
    >
      <span class="text-slate-950 text-xl font-bold">â†‘</span>
    </button>
  </body>
</html>

<script>
  // Loading Screen
  const loadingScreen = document.getElementById('loading-screen') as HTMLElement | null
  const loadingBar = document.getElementById('loading-bar') as HTMLElement | null

  // Simulate loading progress
  let progress = 0
  const loadingInterval = setInterval(() => {
    progress += Math.random() * 30
    if (progress >= 100) {
      progress = 100
      clearInterval(loadingInterval)
    }
    if (loadingBar) {
      loadingBar.style.width = progress + '%'
    }
  }, 100)

  // Hide loading screen when page is fully loaded
  window.addEventListener('load', () => {
    setTimeout(() => {
      if (loadingScreen) {
        loadingScreen.style.opacity = '0'
        loadingScreen.style.transition = 'opacity 0.5s ease'
        setTimeout(() => {
          loadingScreen.style.display = 'none'
        }, 500)
      }
    }, 500)
  })

  // Scroll to Top Button
  const scrollToTopBtn = document.getElementById('scroll-to-top')

  if (scrollToTopBtn) {
    window.addEventListener('scroll', () => {
      if (window.scrollY > 300) {
        scrollToTopBtn.classList.add('show')
      } else {
        scrollToTopBtn.classList.remove('show')
      }
    })

    scrollToTopBtn.addEventListener('click', () => {
      window.scrollTo({
        top: 0,
        behavior: 'smooth',
      })
    })
  }

  // Smooth scroll for anchor links
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      const href = anchor.getAttribute('href')
      if (href && href !== '#' && href.length > 1) {
        e.preventDefault()
        const target = document.querySelector(href)
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start',
          })
        }
      }
    })
  })

  // Add pixel-perfect hover effects to buttons
  const buttons = document.querySelectorAll('.pixel-button')
  buttons.forEach(button => {
    const btn = button as HTMLElement
    btn.addEventListener('mouseenter', () => {
      btn.style.transform = 'translate(-2px, -2px)'
    })
    btn.addEventListener('mouseleave', () => {
      btn.style.transform = 'translate(0, 0)'
    })
  })
</script>
